{% extends "base.html" %}

{% block title %}{{ post.title if post else 'Post Not Found' }} | Cryptasium Blog{% endblock %}

{% block extra_css %}
<style>
    .blog-content {
        line-height: 1.8;
        font-size: 18px;
        color: var(--text-main);
    }
    
    .blog-content p {
        margin-bottom: 1.5em;
    }
    
    .blog-content h1, .blog-content h2, .blog-content h3, .blog-content h4, .blog-content h5, .blog-content h6 {
        margin-top: 1.5em;
        margin-bottom: 0.75em;
        font-weight: 700;
    }
    
    .blog-content h1 { font-size: 2.5em; }
    .blog-content h2 { font-size: 2em; }
    .blog-content h3 { font-size: 1.75em; }
    .blog-content h4 { font-size: 1.5em; }
    .blog-content h5 { font-size: 1.25em; }
    .blog-content h6 { font-size: 1.1em; }
    
    .blog-content ul, .blog-content ol {
        margin: 1.5em 0;
        padding-left: 2em;
    }
    
    .blog-content li {
        margin-bottom: 0.5em;
    }
    
    .blog-content code {
        background: rgba(255,255,255,0.1);
        padding: 2px 6px;
        border-radius: 4px;
        font-family: var(--font-mono);
        font-size: 0.9em;
    }
    
    .blog-content pre {
        background: rgba(255,255,255,0.05);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 1.5em;
        overflow-x: auto;
        margin: 1.5em 0;
    }
    
    .blog-content pre code {
        background: none;
        padding: 0;
        display: block;
    }
    
    .blog-content blockquote {
        border-left: 3px solid var(--accent);
        padding-left: 1.5em;
        margin: 1.5em 0;
        color: var(--text-muted);
        font-style: italic;
    }
    
    .blog-content a {
        color: var(--accent);
        text-decoration: underline;
    }
    
    .blog-content a:hover {
        color: var(--accent-hover);
    }
    
    .blog-content img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        margin: 1.5em 0;
    }
    
    .blog-content table {
        width: 100%;
        border-collapse: collapse;
        margin: 1.5em 0;
    }
    
    .blog-content table th,
    .blog-content table td {
        border: 1px solid var(--border);
        padding: 12px;
        text-align: left;
    }
    
    .blog-content table th {
        background: rgba(255,255,255,0.05);
        font-weight: 600;
    }
    
    .blog-content hr {
        border: none;
        border-top: 1px solid var(--border);
        margin: 2em 0;
    }
    
    .blog-content strong {
        font-weight: 700;
    }
    
    .blog-content em {
        font-style: italic;
    }
    
    .blog-content mark {
        background: rgba(255, 34, 34, 0.3);
        color: var(--text-main);
        padding: 2px 4px;
        border-radius: 4px;
    }
</style>
{% endblock %}

{% block content %}
<article class="container" style="padding: 120px 24px 100px;">
    <div style="max-width: 800px; margin: 0 auto;">
        {% if post %}
        <div class="reveal">
            <a href="{{ url_for('blog_list') }}" style="color: var(--accent); font-size: 14px; margin-bottom: 20px; display: inline-block;">← Back to Blog</a>
            <div class="tag" style="margin-bottom: 20px;">● ARTICLE</div>
            <h1 style="font-size: 56px; line-height: 1.2; margin-bottom: 24px;">{{ post.title }}</h1>
            <div style="display: flex; gap: 24px; margin-bottom: 40px; color: var(--text-muted); font-size: 14px; flex-wrap: wrap;">
                <span>By {{ post.author or 'Cryptasium Team' }}</span>
                <span>•</span>
                <span>{{ post.created_at.strftime('%B %d, %Y') if post.created_at else 'Unknown date' }}</span>
                <span>•</span>
                <span>{{ post.views or 0 }} views</span>
            </div>
        </div>

        {% if post.featured_image %}
        <div class="reveal" style="margin-bottom: 40px;">
            <img src="{{ post.featured_image }}" alt="{{ post.title }}" style="width: 100%; border-radius: 20px; border: 1px solid var(--border);">
        </div>
        {% endif %}

        {% if post.excerpt %}
        <div class="reveal" style="padding: 24px; background: rgba(255,255,255,0.02); border-left: 3px solid var(--accent); border-radius: 8px; margin-bottom: 40px; color: var(--text-muted); font-style: italic;">
            {{ post.excerpt }}
        </div>
        {% endif %}

        {% if post.content %}
        <div class="reveal" style="margin-top: 40px;">
            <div class="blog-content">
                {{ post.content | markdown | safe }}
            </div>
        </div>
        {% else %}
        <div class="reveal" style="line-height: 1.8; font-size: 18px; color: var(--text-muted); padding: 40px; text-align: center; border: 1px solid var(--border); border-radius: 16px; margin-top: 40px;">
            <p>No content available for this post.</p>
        </div>
        {% endif %}
        {% else %}
        <div class="reveal" style="text-align: center; padding: 60px 0;">
            <h1 style="font-size: 48px; margin-bottom: 24px;">Post Not Found</h1>
            <p style="color: var(--text-muted); margin-bottom: 32px;">The blog post you're looking for doesn't exist or has been removed.</p>
            <a href="{{ url_for('blog_list') }}" class="btn btn-primary">Back to Blog</a>
        </div>
        {% endif %}
    </div>
</article>
{% endblock %}

{% block extra_js %}
<script>
    // Ensure reveal elements are visible even if IntersectionObserver hasn't triggered
    document.addEventListener('DOMContentLoaded', function() {
        // Add a small delay to ensure DOM is ready
        setTimeout(function() {
            const reveals = document.querySelectorAll('.reveal');
            reveals.forEach(function(el) {
                // If element is already in viewport, make it visible immediately
                const rect = el.getBoundingClientRect();
                const isVisible = rect.top < window.innerHeight && rect.bottom > 0;
                
                if (isVisible) {
                    el.classList.add('active');
                }
            });
        }, 100);
    });
</script>
{% endblock %}
